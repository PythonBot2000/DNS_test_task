# DNS_test_task

Простой набор скриптов для заполнения базы данных из CSV-файлов и распределения товаров со склада (RC) по филиалам (магазинам).

## Файлы

**populate\_db.py**

1) Импортирует данные из трёх CSV (склад, филиалы, каталог).
2) Генерирует:
    `logdays = 7` для каждой комбинации филиал–категория.
    `priority` в диапазоне от 1 до 5. Выше значение - выше приоритет
    `min_shipment` в диапазоне от 1 до 20.
3) Рассчитывает `needs` на основе остатков, резерва и транзита.

**distribute\_products.py**

На уровне SQL:
    1) Определяет дефицит в филиалах и общий запас на складе.
    2) Пропорционально распределяет первую партию с капом по дефициту.
    3) Сбрасывает отгрузки магазинов, у которых итоговая сумма отгрузок меньше их `min_shipment`, собирая эти товары в остаток.
    4) Доотправляет остаток единиц по убыванию приоритета.
    5) Записывает итог в `shipments`.

## Как запустить

1) Подготовьте `config.ini` (БД и пути к CSV).
2) Скачать нужные модули:
   ```bash
   pip install psycopg2-binary tqdm
   ```
3) Выполните в терминале:
   ```bash
   py populate_db.py
   py distribute_products.py
   ```

Таблица `shipments` будет содержать готовые отгрузки.

